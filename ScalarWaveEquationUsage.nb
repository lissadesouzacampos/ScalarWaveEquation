(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    189536,       4757]
NotebookOptionsPosition[    182702,       4634]
NotebookOutlinePosition[    183200,       4652]
CellTagsIndexPosition[    183157,       4649]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.8119775317308016`*^9, 3.8119775321711683`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"b73ff2ba-a12a-4d5f-9b19-02969dca8e19"],

Cell[BoxData[
 RowBox[{"Import", "[", 
  "\"\<C:\\\\Users\\\\Lissa\\\\Google Drive\\\\Wolfram \
Mathematica\\\\MyPackages\\\\ScalarWaveEquation.m\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"1566c1a4-42cb-4cd2-b999-704304b322a8"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["The scalar wave equation on an n-dimensional \
spacetime",
 FontColor->RGBColor[
  0.49411764705882355`, 0.13333333333333333`, 0.07058823529411765]]], "Title",
 CellChangeTimes->{{3.7991530674758015`*^9, 3.7991531265710564`*^9}, {
   3.7991533745700216`*^9, 3.7991533935782523`*^9}, {3.799155077899369*^9, 
   3.7991550795873775`*^9}, 3.7991555891562524`*^9, {3.799181889464406*^9, 
   3.7991818922089615`*^9}, {3.799327161199168*^9, 3.799327163796682*^9}, {
   3.8119604249390798`*^9, 3.811960448523351*^9}, {3.8119630310154123`*^9, 
   3.811963032350854*^9}},ExpressionUUID->"ac30e820-0294-4cd7-9b48-\
0cf6897ac71f"],

Cell[TextData[StyleBox["For criticism, suggestions and requests: \
lissadesouzacampos@gmail.com",
 FontColor->RGBColor[
  0.34901960784313724`, 0.34901960784313724`, 1.]]], "Author",
 CellChangeTimes->{{3.7993248396641345`*^9, 3.799324954313246*^9}, {
  3.7993265314532595`*^9, 3.7993265333579345`*^9}, {3.7997824963822165`*^9, 
  3.7997825010636053`*^9}},ExpressionUUID->"2736abb2-a875-41d4-be90-\
7299de9e1855"],

Cell[TextData[{
 "This package implements only the function: ",
 StyleBox["ScalarWaveEquation[]", "Code",
  FontColor->RGBColor[
   0.49411764705882355`, 0.13333333333333333`, 0.07058823529411765],
  Background->RGBColor[1., 0.4745098039215686, 1.]],
 StyleBox[". It receives data of a metric tensor and returns the \
corresponding scalar wave equation with a potential term:",
  Background->GrayLevel[1]]
}], "Text",
 CellChangeTimes->{{3.7991529871015306`*^9, 3.7991530089549894`*^9}, {
  3.7991533106990175`*^9, 3.7991533460828214`*^9}, {3.799176643047202*^9, 
  3.7991766721115103`*^9}, {3.7991767063762474`*^9, 3.7991768138397045`*^9}, {
  3.7991781663361607`*^9, 3.7991781752076054`*^9}, {3.79978278108628*^9, 
  3.7997830950846386`*^9}, {3.8119755274218626`*^9, 
  3.8119755506056795`*^9}},ExpressionUUID->"96bd5ab5-ab6b-455e-bdcf-\
890ee9b5a8b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       SqrtBox[
        RowBox[{"|", 
         RowBox[{"Det", "[", "g", "]"}], "|"}]]], " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Mu]"], 
       RowBox[{"(", 
        RowBox[{
         SqrtBox[
          RowBox[{"|", 
           RowBox[{"Det", "[", "g", "]"}], "|"}]], 
         SuperscriptBox["g", "\[Mu]\[Nu]"], 
         SubscriptBox["\[PartialD]", "\[Nu]"]}], ")"}]}]}], "-", 
     SuperscriptBox["m", "2"]}], " ", ")"}], " ", "\[CapitalPsi]"}], " ", "=",
   " ", "0"}]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7991536021879873`*^9, 3.7991536545963135`*^9}, {
   3.799180886497305*^9, 3.799180910312105*^9}, {3.811960683091345*^9, 
   3.811960696697175*^9}, {3.811960735116106*^9, 3.811960816370033*^9}, {
   3.811962441014402*^9, 3.811962443359384*^9}, {3.8119696779246373`*^9, 
   3.8119696790291824`*^9}, 3.811974536465767*^9},
 TextAlignment->Center,ExpressionUUID->"6d67255a-d232-402f-a6f1-80fb5834af95"],

Cell["\<\
I have only tested it for diagonal, static metrics. That\[CloseCurlyQuote]s \
all I need. But it should work in a general metric \
\>", "Text",
 CellChangeTimes->{{3.8119756221734776`*^9, 
  3.811975687317994*^9}},ExpressionUUID->"76d98c0d-0d84-4e85-96c2-\
763e24dee851"],

Cell[BoxData[
 RowBox[{"Import", "[", "\"\<ScalarWaveEquation.m\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8119715919654827`*^9, 3.81197163729904*^9}, 
   3.811971690142315*^9, 
   3.811978970548709*^9},ExpressionUUID->"92b7f799-d19c-4fa6-8846-\
af311df91674"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"?", " ", "ScalarWaveEquation"}],
  FontColor->RGBColor[
   0.49411764705882355`, 0.13333333333333333`, 0.07058823529411765],
  Background->RGBColor[1., 0.4745098039215686, 1.]]], "Input",
 CellChangeTimes->{{3.811974488608056*^9, 3.8119744890031333`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"db9235ca-cfea-4626-ba92-ae813f4b153b"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\" ScalarWaveEquation['sol'->\[CapitalPsi],'mass'->m] \
gives the (massive) scalar wave equation, on a spacetime with metric tensor g\
\\n(\\!\\(\\*FractionBox[\\(1\\), \
SqrtBox[\\(\\(|\\)\\(Det[g]\\)\\(|\\)\\)]]\\) \\!\\(\\*SubscriptBox[\\(\
\[PartialD]\\), \
\\(\[Mu]\\)]\\)(\\!\\(\\*SqrtBox[\\(\\(|\\)\\(Det[g]\\)\\(|\\)\\)]\\)\\!\\(\\*\
SuperscriptBox[\\(g\\), \\(\[Mu]\[Nu]\\)]\\)\\!\\(\\*SubscriptBox[\\(\
\[PartialD]\\), \\(\[Nu]\\)]\\))- \\!\\(\\*SuperscriptBox[\\(m\\), \
\\(2\\)]\\) ) \[CapitalPsi] = 0. One can provide the data of the metric \
through the options 'spacetime', 'diagonal_metric' or 'metric'. Please check \
the documentation for more information.\\n\\t\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False, False, False, False, 
                False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Definitions\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Definitions", "Tooltip"]& ], GridBox[{
                    {
                    RowBox[{
                    RowBox[{"ScalarWaveEquation", "[", 
                    RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "g", ",", "n", ",", "coordinates", ",", "mass", ",", 
                    "ginv", ",", "moduleDet", ",", "ansatz", ",", "Sol", ",", 
                    "\[CapitalPsi]", ",", "waveEq"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"metricDictionary", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\<\"Minkowski Spherical n=4\"\>", ",", 
                    RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", 
                    SuperscriptBox["r", "2"], ",", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"Schwarzschild n=4\"\>", ",", 
                    RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{"2", " ", "M"}], "r"]}], ")"}]}], ",", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{"2", " ", "M"}], "r"]}]], ",", 
                    SuperscriptBox["r", "2"], ",", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"Kerr n=4\"\>", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{"2", " ", "M", " ", "r"}], 
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}], ",", 
                    "0", ",", "0", ",", 
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"2", " ", "a", " ", "M", " ", "r", " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], 
                    RowBox[{
                    SuperscriptBox["a", "2"], "-", 
                    RowBox[{"2", " ", "M", " ", "r"}], "+", 
                    SuperscriptBox["r", "2"]}]], ",", "0", ",", "0"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ",", 
                    "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"2", " ", "a", " ", "M", " ", "r", " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}], ",", 
                    "0", ",", "0", ",", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["a", "2"], "+", 
                    SuperscriptBox["r", "2"], "+", 
                    FractionBox[
                    RowBox[{"2", " ", 
                    SuperscriptBox["a", "2"], " ", "M", " ", "r", " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}], 
                    ")"}]}]}], "}"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"static spherically symmetric n=4\"\>", ",", 
                    RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"f", "[", "r", "]"}]}], ",", 
                    FractionBox["1", 
                    RowBox[{"f", "[", "r", "]"}]], ",", 
                    SuperscriptBox["r", "2"], ",", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"AdS Global n=4\"\>", ",", 
                    RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}], ")"}]}], ",", 
                    FractionBox["1", 
                    RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}]], ",", 
                    SuperscriptBox["r", "2"], ",", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"Rindler-AdS n=4\"\>", ",", 
                    RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    SuperscriptBox["r", "2"], 
                    SuperscriptBox["L", "2"]]}], ",", 
                    FractionBox["1", 
                    RowBox[{"1", "+", 
                    FractionBox[
                    SuperscriptBox["r", "2"], 
                    SuperscriptBox["L", "2"]]}]], ",", 
                    RowBox[{"1", "+", 
                    FractionBox[
                    SuperscriptBox["r", "2"], 
                    SuperscriptBox["L", "2"]]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    FractionBox[
                    SuperscriptBox["r", "2"], 
                    SuperscriptBox["L", "2"]]}], ")"}], " ", 
                    SuperscriptBox["L", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Sinh", "[", 
                    FractionBox["\[Theta]", "L"], "]"}], "2"]}]}], "}"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"Schwarzschild-AdS n=4\"\>", ",", 
                    RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{"2", " ", "M"}], "r"], "+", 
                    RowBox[{"k", " ", 
                    SuperscriptBox["r", "2"]}]}], ")"}]}], ",", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{"2", " ", "M"}], "r"], "+", 
                    RowBox[{"k", " ", 
                    SuperscriptBox["r", "2"]}]}]], ",", 
                    SuperscriptBox["r", "2"], ",", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"Static BTZ n=3\"\>", ",", 
                    RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["r", "2"], "-", "M"}], ")"}]}], ",", 
                    FractionBox["1", 
                    RowBox[{
                    SuperscriptBox["r", "2"], "-", "M"}]], ",", 
                    SuperscriptBox["r", "2"]}], "}"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"Rindler-AdS n=3\"\>", ",", 
                    RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["r", "2"], "-", 
                    SuperscriptBox["rh", "2"]}], ")"}]}], ",", 
                    FractionBox["1", 
                    RowBox[{
                    SuperscriptBox["r", "2"], "-", 
                    SuperscriptBox["rh", "2"]}]], ",", 
                    SuperscriptBox["r", "2"]}], "}"}], "]"}]}], "}"}]}], 
                    "}"}]}], ";", 
                    RowBox[{"g", "=", 
                    RowBox[{"{", "}"}]}], ";", 
                    RowBox[{"coordinates", "=", 
                    RowBox[{"{", "}"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\<\"metric\"\>", "]"}], "=!=", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"g", "=", 
                    RowBox[{"OptionValue", "[", "\<\"metric\"\>", "]"}]}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "OptionValue", "[", "\<\"diagonal_metric\"\>", "]"}], "=!=", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"g", "=", 
                    RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{
                    "OptionValue", "[", "\<\"diagonal_metric\"\>", "]"}], 
                    "]"}]}]}], "]"}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"g", "=!=", 
                    RowBox[{"{", "}"}]}], "&&", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\<\"coordinates\"\>", "]"}], 
                    "=!=", 
                    RowBox[{"{", "}"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"n", "=", 
                    RowBox[{"Length", "[", "g", "]"}]}], ";", 
                    RowBox[{"coordinates", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\<\"coordinates\"\>", "]"}], 
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}]}], 
                    "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"g", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\<\"spacetime\"\>", "]"}], "=!=", 
                    RowBox[{"{", "}"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"metricDictionary", ",", 
                    RowBox[{"OptionValue", "[", "\<\"spacetime\"\>", "]"}]}], 
                    "]"}], "=!=", 
                    RowBox[{"{", "}"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"g", "=", 
                    RowBox[{"metricDictionary", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"metricDictionary", ",", 
                    RowBox[{"OptionValue", "[", "\<\"spacetime\"\>", "]"}]}], 
                    "]"}], "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    "2"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"n", "=", 
                    RowBox[{"Length", "[", "g", "]"}]}], ";", 
                    RowBox[{"coordinates", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "\[Equal]", "3"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "r", ",", "\[Theta]"}], "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "\[Equal]", "4"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "t", ",", "r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], 
                    "}"}]}], "]"}]}], "]"}]}]}]}], "]"}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"g", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"Message", "[", 
                    StyleBox[
                    RowBox[{"ScalarWaveEquation", "::", "invMetric"}], 
                    "MessageName"], "]"}], ";", 
                    RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"coordinates", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"Message", "[", 
                    StyleBox[
                    RowBox[{"ScalarWaveEquation", "::", "invCoords"}], 
                    "MessageName"], "]"}], ";", 
                    RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\<\"ansatz\"\>", "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", "}"}]}], "&&", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\<\"sol\"\>", "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", "}"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"Message", "[", 
                    StyleBox[
                    RowBox[{"ScalarWaveEquation", "::", "invSol"}], 
                    "MessageName"], "]"}], ";", 
                    RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
                    RowBox[{"mass", "=", 
                    RowBox[{"OptionValue", "[", "\<\"mass\"\>", "]"}]}], ";", 
                    RowBox[{"ginv", "=", 
                    RowBox[{"Inverse", "[", "g", "]"}]}], ";", 
                    RowBox[{"moduleDet", "=", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\<\"Lorentzian\"\>", "]"}], 
                    ",", 
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"+", "1"}]}], "]"}], " ", 
                    RowBox[{"Det", "[", "g", "]"}]}]]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\<\"ansatz\"\>", "]"}], "===", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"ansatz", "=", "1"}], ";", 
                    RowBox[{"Sol", "=", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\<\"sol\"\>", "]"}], "[", 
                    "coordinates", "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"ansatz", "=", 
                    RowBox[{
                    UnderoverscriptBox["\[Product]", 
                    RowBox[{"i", "=", "1"}], 
                    RowBox[{"Length", "[", 
                    RowBox[{"OptionValue", "[", "\<\"ansatz\"\>", "]"}], 
                    "]"}]], 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\<\"ansatz\"\>", "]"}], 
                    "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], ";", 
                    RowBox[{"Sol", "=", "ansatz"}]}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"g", "-", 
                    RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{"Diagonal", "[", "g", "]"}], "]"}]}], "=!=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
                    RowBox[{"waveEq", "=", 
                    FractionBox[
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"\[Mu]", "=", "1"}], "n"], 
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"\[Nu]", "=", "1"}], "n"], 
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{
                    "coordinates", "\[LeftDoubleBracket]", "\[Mu]", 
                    "\[RightDoubleBracket]"}]], 
                    RowBox[{"(", 
                    RowBox[{"moduleDet", " ", 
                    RowBox[{"ginv", "\[LeftDoubleBracket]", 
                    RowBox[{"\[Mu]", ",", "\[Nu]"}], 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{
                    "coordinates", "\[LeftDoubleBracket]", "\[Nu]", 
                    "\[RightDoubleBracket]"}]], "Sol"}]}], ")"}]}]}], ")"}]}],
                     "moduleDet"], "-", 
                    RowBox[{
                    SuperscriptBox["mass", "2"], " ", "Sol"}]}], "ansatz"]}], 
                    ",", 
                    RowBox[{"waveEq", "=", 
                    RowBox[{"FullSimplify", "[", 
                    FractionBox[
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"\[Mu]", "=", "1"}], "n"], 
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"\[Nu]", "=", "1"}], "n"], 
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{
                    "coordinates", "\[LeftDoubleBracket]", "\[Mu]", 
                    "\[RightDoubleBracket]"}]], 
                    RowBox[{"(", 
                    RowBox[{"moduleDet", " ", 
                    RowBox[{"ginv", "\[LeftDoubleBracket]", 
                    RowBox[{"\[Mu]", ",", "\[Nu]"}], 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{
                    "coordinates", "\[LeftDoubleBracket]", "\[Nu]", 
                    "\[RightDoubleBracket]"}]], "Sol"}]}], ")"}]}]}], ")"}]}],
                     "moduleDet"], "-", 
                    RowBox[{
                    SuperscriptBox["mass", "2"], " ", "Sol"}]}], "ansatz"], 
                    "]"}]}]}], "]"}], ";", 
                    RowBox[{"Return", "[", 
                    RowBox[{"Collect", "[", 
                    RowBox[{"waveEq", ",", 
                    RowBox[{"OptionValue", "[", "\<\"ansatz\"\>", "]"}]}], 
                    "]"}], "]"}]}]}], "]"}]}]}
                    },
                    DefaultBaseStyle->"Column",
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                  {
                   PaneSelectorBox[{True->
                    ButtonBox[
                    PaneSelectorBox[{False->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "DownPointerOpener"]]},
                    "RowWithSeparators"], True->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "DownPointerOpenerHot"]]},
                    "RowWithSeparators"]}, Dynamic[
                    CurrentValue["MouseOver"]],
                    FrameMargins->0,
                    ImageSize->Automatic],
                    Appearance->None,
                    BaseStyle->None,
                    
                    ButtonFunction:>(Part[System`InformationDump`open$$, 9] = 
                    False),
                    Evaluator->Automatic,
                    FrameMargins->0,
                    ImageMargins->0,
                    Method->"Preemptive"], False->
                    ButtonBox[
                    PaneSelectorBox[{False->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "RightPointerOpener"]]},
                    "RowWithSeparators"], True->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "RightPointerOpenerHot"]]},
                    "RowWithSeparators"]}, Dynamic[
                    CurrentValue["MouseOver"]],
                    FrameMargins->0,
                    ImageSize->Automatic],
                    Appearance->None,
                    BaseStyle->None,
                    
                    ButtonFunction:>(Part[System`InformationDump`open$$, 9] = 
                    True),
                    Evaluator->Automatic,
                    FrameMargins->0,
                    ImageMargins->0,
                    Method->"Preemptive"]}, Dynamic[
                    FEPrivate`Part[System`InformationDump`open$$, 9]]], 
                   PaneSelectorBox[{True->GridBox[{
                    {
                    RowBox[{"\<\"spacetime\"\>", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    RowBox[{"\<\"diagonal_metric\"\>", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    RowBox[{"\<\"metric\"\>", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    RowBox[{"\<\"coordinates\"\>", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    RowBox[{"\<\"Lorentzian\"\>", "\[Rule]", "\<\"True\"\>"}]},
                    {
                    RowBox[{"\<\"ansatz\"\>", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]},
                    {
                    RowBox[{"\<\"sol\"\>", "\[Rule]", 
                    RowBox[{"{", "}"}]}]},
                    {
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[InvisibleSpace]\"", "8", "\" total)\""},
                    "RowDefault"], "InformationRowOpener",
                    StripOnInput->False]}
                    },
                    BaselinePosition->{Baseline, {1, 1}},
                    DefaultBaseStyle->"Column",
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{1.}}}], False->
                    RowBox[{
                    RowBox[{"\<\"spacetime\"\>", "\[Rule]", 
                    RowBox[{"{", "}"}]}], "\[ThinSpace]", 
                    StyleBox["\<\"\[Ellipsis]\"\>", "InformationRowOpener",
                    StripOnInput->False], "\[ThinSpace]", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[InvisibleSpace]\"", "8", "\" total)\""},
                    "RowDefault"], "InformationRowOpener",
                    StripOnInput->False]}]}, Dynamic[
                    FEPrivate`Part[System`InformationDump`open$$, 9]],
                    BaselinePosition->Baseline,
                    ImageSize->Automatic]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"ScalarWaveEquation`ScalarWaveEquation\
\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->6], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\" ScalarWaveEquation['sol'->\[CapitalPsi],'mass'->m] \
gives the (massive) scalar wave equation, on a spacetime with metric tensor g\
\\n(\\!\\(\\*FractionBox[\\(1\\), \
SqrtBox[\\(\\(|\\)\\(Det[g]\\)\\(|\\)\\)]]\\) \\!\\(\\*SubscriptBox[\\(\
\[PartialD]\\), \
\\(\[Mu]\\)]\\)(\\!\\(\\*SqrtBox[\\(\\(|\\)\\(Det[g]\\)\\(|\\)\\)]\\)\\!\\(\\*\
SuperscriptBox[\\(g\\), \\(\[Mu]\[Nu]\\)]\\)\\!\\(\\*SubscriptBox[\\(\
\[PartialD]\\), \\(\[Nu]\\)]\\))- \\!\\(\\*SuperscriptBox[\\(m\\), \
\\(2\\)]\\) ) \[CapitalPsi] = 0. One can provide the data of the metric \
through the options 'spacetime', 'diagonal_metric' or 'metric'. Please check \
the documentation for more information.\\n\\t\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{10., {3., 7.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{10., {3., 7.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[
   Association[
   "ObjectType" -> "Symbol", "Usage" -> 
    " ScalarWaveEquation['sol'->\[CapitalPsi],'mass'->m] gives the (massive) \
scalar wave equation, on a spacetime with metric tensor g\n\
(\!\(\*FractionBox[\(1\), SqrtBox[\(\(|\)\(Det[g]\)\(|\)\)]]\) \
\!\(\*SubscriptBox[\(\[PartialD]\), \
\(\[Mu]\)]\)(\!\(\*SqrtBox[\(\(|\)\(Det[g]\)\(|\)\)]\)\!\(\*SuperscriptBox[\(\
g\), \(\[Mu]\[Nu]\)]\)\!\(\*SubscriptBox[\(\[PartialD]\), \(\[Nu]\)]\))- \!\(\
\*SuperscriptBox[\(m\), \(2\)]\) ) \[CapitalPsi] = 0. One can provide the \
data of the metric through the options 'spacetime', 'diagonal_metric' or \
'metric'. Please check the documentation for more information.\n\t", 
    "Documentation" -> None, "OwnValues" -> None, "UpValues" -> None, 
    "DownValues" -> 
    Information`InformationValueForm[
     DownValues, ScalarWaveEquation`ScalarWaveEquation, {
      ScalarWaveEquation`ScalarWaveEquation[
         OptionsPattern[]] :> 
       Module[{ScalarWaveEquation`g, ScalarWaveEquation`n, 
          ScalarWaveEquation`coordinates, ScalarWaveEquation`mass, 
          ScalarWaveEquation`ginv, ScalarWaveEquation`moduleDet, 
          ScalarWaveEquation`ansatz, ScalarWaveEquation`Sol, 
          ScalarWaveEquation`\[CapitalPsi], ScalarWaveEquation`waveEq}, 
         ScalarWaveEquation`metricDictionary = {{"Minkowski Spherical n=4", 
             
             DiagonalMatrix[{-1, 1, ScalarWaveEquation`r^2, 
               ScalarWaveEquation`r^2 Sin[ScalarWaveEquation`\[Theta]]^2}]}, {
            "Schwarzschild n=4", 
             
             DiagonalMatrix[{-(1 - (2 ScalarWaveEquation`M)/
                ScalarWaveEquation`r), (1 - (2 ScalarWaveEquation`M)/
                ScalarWaveEquation`r)^(-1), ScalarWaveEquation`r^2, 
               ScalarWaveEquation`r^2 Sin[ScalarWaveEquation`\[Theta]]^2}]}, {
            "Kerr n=4", {{
              1 - (2 ScalarWaveEquation`M ScalarWaveEquation`r)/(
               ScalarWaveEquation`r^2 + 
               ScalarWaveEquation`a^2 Cos[ScalarWaveEquation`\[Theta]]^2), 0, 
               0, -((2 ScalarWaveEquation`a ScalarWaveEquation`M 
                 ScalarWaveEquation`r Sin[ScalarWaveEquation`\[Theta]]^2)/(
                ScalarWaveEquation`r^2 + 
                ScalarWaveEquation`a^2 
                 Cos[ScalarWaveEquation`\[Theta]]^2))}, {
              0, (ScalarWaveEquation`r^2 + 
                ScalarWaveEquation`a^2 Cos[ScalarWaveEquation`\[Theta]]^2)/(
               ScalarWaveEquation`a^2 - 2 ScalarWaveEquation`M 
               ScalarWaveEquation`r + ScalarWaveEquation`r^2), 0, 0}, {
              0, 0, ScalarWaveEquation`r^2 + 
               ScalarWaveEquation`a^2 Cos[ScalarWaveEquation`\[Theta]]^2, 
               0}, {-((2 ScalarWaveEquation`a ScalarWaveEquation`M 
                 ScalarWaveEquation`r Sin[ScalarWaveEquation`\[Theta]]^2)/(
                ScalarWaveEquation`r^2 + 
                ScalarWaveEquation`a^2 Cos[ScalarWaveEquation`\[Theta]]^2)), 
               0, 0, Sin[ScalarWaveEquation`\[Theta]]^2 (
                ScalarWaveEquation`a^2 + 
                ScalarWaveEquation`r^2 + (2 ScalarWaveEquation`a^2 
                  ScalarWaveEquation`M ScalarWaveEquation`r 
                  Sin[ScalarWaveEquation`\[Theta]]^2)/(ScalarWaveEquation`r^2 + 
                 ScalarWaveEquation`a^2 
                  Cos[ScalarWaveEquation`\[Theta]]^2))}}}, {
            "static spherically symmetric n=4", 
             
             DiagonalMatrix[{-ScalarWaveEquation`f[ScalarWaveEquation`r], 
               ScalarWaveEquation`f[ScalarWaveEquation`r]^(-1), 
               ScalarWaveEquation`r^2, ScalarWaveEquation`r^2 
               Sin[ScalarWaveEquation`\[Theta]]^2}]}, {"AdS Global n=4", 
             
             DiagonalMatrix[{-(1 + ScalarWaveEquation`r^2), (1 + 
                ScalarWaveEquation`r^2)^(-1), ScalarWaveEquation`r^2, 
               ScalarWaveEquation`r^2 Sin[ScalarWaveEquation`\[Theta]]^2}]}, {
            "Rindler-AdS n=4", 
             
             DiagonalMatrix[{-(ScalarWaveEquation`r^2/
                ScalarWaveEquation`L^2), (1 + 
                ScalarWaveEquation`r^2/ScalarWaveEquation`L^2)^(-1), 1 + 
               ScalarWaveEquation`r^2/ScalarWaveEquation`L^2, (1 + 
                ScalarWaveEquation`r^2/ScalarWaveEquation`L^2) 
               ScalarWaveEquation`L^2 
               Sinh[ScalarWaveEquation`\[Theta]/ScalarWaveEquation`L]^2}]}, {
            "Schwarzschild-AdS n=4", 
             
             DiagonalMatrix[{-(1 - (2 ScalarWaveEquation`M)/
                ScalarWaveEquation`r + 
                ScalarWaveEquation`k ScalarWaveEquation`r^2), (
                1 - (2 ScalarWaveEquation`M)/ScalarWaveEquation`r + 
                ScalarWaveEquation`k ScalarWaveEquation`r^2)^(-1), 
               ScalarWaveEquation`r^2, ScalarWaveEquation`r^2 
               Sin[ScalarWaveEquation`\[Theta]]^2}]}, {"Static BTZ n=3", 
             
             DiagonalMatrix[{-(ScalarWaveEquation`r^2 - 
                ScalarWaveEquation`M), (ScalarWaveEquation`r^2 - 
                ScalarWaveEquation`M)^(-1), ScalarWaveEquation`r^2}]}, {
            "Rindler-AdS n=3", 
             
             DiagonalMatrix[{-(ScalarWaveEquation`r^2 - 
                ScalarWaveEquation`rh^2), (ScalarWaveEquation`r^2 - 
                ScalarWaveEquation`rh^2)^(-1), ScalarWaveEquation`r^2}]}}; 
         ScalarWaveEquation`g = {}; ScalarWaveEquation`coordinates = {}; 
         If[OptionValue["metric"] =!= {}, ScalarWaveEquation`g = 
           OptionValue["metric"], 
           If[
           OptionValue["diagonal_metric"] =!= {}, ScalarWaveEquation`g = 
            DiagonalMatrix[
              OptionValue["diagonal_metric"]]]]; If[
           And[
           ScalarWaveEquation`g =!= {}, OptionValue["coordinates"] =!= {}], 
           ScalarWaveEquation`n = Length[ScalarWaveEquation`g]; 
           ScalarWaveEquation`coordinates = Table[
              Part[
               OptionValue["coordinates"], ScalarWaveEquation`i], {
              ScalarWaveEquation`i, 1, ScalarWaveEquation`n}]]; 
         If[ScalarWaveEquation`g == {}, 
           If[
            And[
            OptionValue["spacetime"] =!= {}, 
             Position[ScalarWaveEquation`metricDictionary, 
               OptionValue["spacetime"]] =!= {}], 
            ScalarWaveEquation`g = Part[ScalarWaveEquation`metricDictionary, 
               Part[
                Position[ScalarWaveEquation`metricDictionary, 
                 OptionValue["spacetime"]], 1, 1], 2]; 
            ScalarWaveEquation`n = Length[ScalarWaveEquation`g]; 
            ScalarWaveEquation`coordinates = 
             If[ScalarWaveEquation`n == 3, {
               ScalarWaveEquation`t, ScalarWaveEquation`r, 
                ScalarWaveEquation`\[Theta]}, 
               If[
               ScalarWaveEquation`n == 4, {
                ScalarWaveEquation`t, ScalarWaveEquation`r, 
                 ScalarWaveEquation`\[Theta], 
                 ScalarWaveEquation`\[CurlyPhi]}]]]]; 
         If[ScalarWaveEquation`g == {}, Message[
             MessageName[ScalarWaveEquation`ScalarWaveEquation, "invMetric"]]; 
           Return[]]; If[ScalarWaveEquation`coordinates == {}, Message[
             MessageName[ScalarWaveEquation`ScalarWaveEquation, "invCoords"]]; 
           Return[]]; If[
           And[OptionValue["ansatz"] == {}, OptionValue["sol"] == {}], Message[
             MessageName[ScalarWaveEquation`ScalarWaveEquation, "invSol"]]; 
           Return[]]; ScalarWaveEquation`mass = OptionValue["mass"]; 
         ScalarWaveEquation`ginv = Inverse[ScalarWaveEquation`g]; 
         ScalarWaveEquation`moduleDet = Sqrt[If[
              OptionValue["Lorentzian"], -1, 
              Plus[1]] Det[ScalarWaveEquation`g]]; 
         If[OptionValue["ansatz"] === {}, ScalarWaveEquation`ansatz = 1; 
           ScalarWaveEquation`Sol = 
            OptionValue["sol"][ScalarWaveEquation`coordinates], 
           ScalarWaveEquation`ansatz = Product[
              Part[
               OptionValue["ansatz"], ScalarWaveEquation`i], {
              ScalarWaveEquation`i, 1, 
               Length[
                OptionValue["ansatz"]]}]; 
           ScalarWaveEquation`Sol = ScalarWaveEquation`ansatz]; 
         If[ScalarWaveEquation`g - DiagonalMatrix[
             Diagonal[ScalarWaveEquation`g]] =!= 
           Table[0, {ScalarWaveEquation`i, 1, ScalarWaveEquation`n}, {
             ScalarWaveEquation`j, 1, ScalarWaveEquation`n}], 
           ScalarWaveEquation`waveEq = 
           1 ScalarWaveEquation`ansatz^(-1) (
             1 ScalarWaveEquation`moduleDet^(-1) Sum[
                Sum[
                 D[
                 ScalarWaveEquation`moduleDet 
                  Part[ScalarWaveEquation`ginv, ScalarWaveEquation`\[Mu], 
                    ScalarWaveEquation`\[Nu]] D[ScalarWaveEquation`Sol, 
                    Part[
                    ScalarWaveEquation`coordinates, 
                    ScalarWaveEquation`\[Nu]]], 
                  Part[
                  ScalarWaveEquation`coordinates, 
                   ScalarWaveEquation`\[Mu]]], {
                 ScalarWaveEquation`\[Nu], 1, ScalarWaveEquation`n}], {
                ScalarWaveEquation`\[Mu], 1, ScalarWaveEquation`n}] - 
             ScalarWaveEquation`mass^2 ScalarWaveEquation`Sol), 
           ScalarWaveEquation`waveEq = 
           FullSimplify[
            1 ScalarWaveEquation`ansatz^(-1) (
              1 ScalarWaveEquation`moduleDet^(-1) Sum[
                 Sum[
                  D[
                  ScalarWaveEquation`moduleDet 
                   Part[ScalarWaveEquation`ginv, ScalarWaveEquation`\[Mu], 
                    ScalarWaveEquation`\[Nu]] D[ScalarWaveEquation`Sol, 
                    Part[
                    ScalarWaveEquation`coordinates, 
                    ScalarWaveEquation`\[Nu]]], 
                   Part[
                   ScalarWaveEquation`coordinates, 
                    ScalarWaveEquation`\[Mu]]], {
                  ScalarWaveEquation`\[Nu], 1, ScalarWaveEquation`n}], {
                 ScalarWaveEquation`\[Mu], 1, ScalarWaveEquation`n}] - 
              ScalarWaveEquation`mass^2 ScalarWaveEquation`Sol)]]; Return[
           Collect[ScalarWaveEquation`waveEq, 
            OptionValue["ansatz"]]]]}], "SubValues" -> None, "DefaultValues" -> 
    None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> {
     "spacetime" -> {}, "diagonal_metric" -> {}, "metric" -> {}, 
      "coordinates" -> {}, "Lorentzian" -> "True", "ansatz" -> {}, "mass" -> 
      0, "sol" -> {}}, "Attributes" -> {}, "FullName" -> 
    "ScalarWaveEquation`ScalarWaveEquation"], False]]], "Output",
 CellChangeTimes->{3.81197448955425*^9, 3.811977047502182*^9, 
  3.8175713204938755`*^9, 3.8175713641585445`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"b001d4c5-f0b7-4ba1-9629-cb4661c740ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScalarWaveEquation", "[", "]"}]], "Input",
 CellChangeTimes->{{3.817571897613659*^9, 3.8175719000351896`*^9}, 
   3.8175724469028563`*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"ce30a9a0-cd67-444a-8766-29615d2ba99b"],

Cell[BoxData["\<\"(\\!\\(\\*FractionBox[\\(1\\), \
SqrtBox[\\(\\(|\\)\\(Det[g]\\)\\(|\\)\\)]]\\) \\!\\(\\*SubscriptBox[\\(\
\[PartialD]\\), \
\\(\[Mu]\\)]\\)(\\!\\(\\*SqrtBox[\\(\\(|\\)\\(Det[g]\\)\\(|\\)\\)]\\)\\!\\(\\*\
SuperscriptBox[\\(g\\), \\(\[Mu]\[Nu]\\)]\\)\\!\\(\\*SubscriptBox[\\(\
\[PartialD]\\), \\(\[Nu]\\)]\\))- \\!\\(\\*SuperscriptBox[\\(m\\), \
\\(2\\)]\\) ) \[CapitalPsi] = 0\"\>"], "Print",
 CellChangeTimes->{3.8175719003256903`*^9, 3.8175724145102496`*^9, 
  3.817572447251829*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"d816fb23-1438-40d0-ae8d-030bb7e2dbfa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["There are three different ways of choosing the metric \
tensor. ",
 FontColor->RGBColor[
  0.49411764705882355`, 0.13333333333333333`, 
   0.07058823529411765]]], "Section",
 CellChangeTimes->{{3.8119699331260815`*^9, 3.811970020216326*^9}, {
  3.811970074069496*^9, 3.8119700773024535`*^9}, {3.8119701808606973`*^9, 
  3.81197018950849*^9}},ExpressionUUID->"55464637-aa7d-4d7a-924a-\
9974d469d9a8"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["By the name of the spacetime.",
 FontColor->RGBColor[
  0.7764705882352941, 0., 0.7764705882352941]]], "Subsubsection",
 CellChangeTimes->{{3.811970166494561*^9, 
  3.8119701726135197`*^9}},ExpressionUUID->"6baf5bd3-378e-4d25-802a-\
0b6cab5c1616"],

Cell["\<\
That is, setting the \"spacetime\" option as one of the list \
\"metricDictionary\". The options are :\
\>", "Text",
 CellChangeTimes->{{3.8119701816334596`*^9, 
  3.8119701831715155`*^9}},ExpressionUUID->"7e9546e8-ce3a-4826-8d8f-\
533281010c05"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "metricDictionary"}]], "Input",
 CellChangeTimes->{{3.811970029174378*^9, 3.811970061987609*^9}, {
  3.8119719959505634`*^9, 3.8119719994331675`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"06c8ca99-3704-4c6e-999b-ccf8482d3234"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\" Dictionary with spacetime names and their metrics. \
Options of spacetimes are: 'Minkowski Spherical n=4', 'Schwarzschild \
n=4','Kerr n=4', 'static spherically','AdS Global n=4','Rindler-AdS \
n=4','Schwarzschild-AdS n=4','Static BTZ n=3','Rindler-AdS n=3.\"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False, False, False, False, 
                False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Assignment\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"OwnValues\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "OwnValues", "Tooltip"]& ], GridBox[{
                    {
                    RowBox[{"metricDictionary", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\<\"Minkowski Spherical n=4\"\>", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    SuperscriptBox["r", "2"], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], 
                    "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"Schwarzschild n=4\"\>", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    FractionBox[
                    RowBox[{"2", " ", "M"}], "r"]}], ",", "0", ",", "0", ",", 
                    "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{"2", " ", "M"}], "r"]}]], ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    SuperscriptBox["r", "2"], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], 
                    "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"Kerr n=4\"\>", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{"2", " ", "M", " ", "r"}], 
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}], ",", 
                    "0", ",", "0", ",", 
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"2", " ", "a", " ", "M", " ", "r", " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], 
                    RowBox[{
                    SuperscriptBox["a", "2"], "-", 
                    RowBox[{"2", " ", "M", " ", "r"}], "+", 
                    SuperscriptBox["r", "2"]}]], ",", "0", ",", "0"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ",", 
                    "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"2", " ", "a", " ", "M", " ", "r", " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}], ",", 
                    "0", ",", "0", ",", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["a", "2"], "+", 
                    SuperscriptBox["r", "2"], "+", 
                    FractionBox[
                    RowBox[{"2", " ", 
                    SuperscriptBox["a", "2"], " ", "M", " ", "r", " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}], 
                    ")"}]}]}], "}"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"static spherically symmetric n=4\"\>", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"f", "[", "r", "]"}]}], ",", "0", ",", "0", ",", 
                    "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    FractionBox["1", 
                    RowBox[{"f", "[", "r", "]"}]], ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    SuperscriptBox["r", "2"], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], 
                    "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"AdS Global n=4\"\>", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "-", 
                    SuperscriptBox["r", "2"]}], ",", "0", ",", "0", ",", 
                    "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    FractionBox["1", 
                    RowBox[{"1", "+", 
                    SuperscriptBox["r", "2"]}]], ",", "0", ",", "0"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    SuperscriptBox["r", "2"], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], 
                    "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"Rindler-AdS n=4\"\>", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    SuperscriptBox["r", "2"], 
                    SuperscriptBox["L", "2"]]}], ",", "0", ",", "0", ",", 
                    "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    FractionBox["1", 
                    RowBox[{"1", "+", 
                    FractionBox[
                    SuperscriptBox["r", "2"], 
                    SuperscriptBox["L", "2"]]}]], ",", "0", ",", "0"}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"1", "+", 
                    FractionBox[
                    SuperscriptBox["r", "2"], 
                    SuperscriptBox["L", "2"]]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", 
                    RowBox[{
                    SuperscriptBox["L", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    FractionBox[
                    SuperscriptBox["r", "2"], 
                    SuperscriptBox["L", "2"]]}], ")"}], " ", 
                    SuperscriptBox[
                    RowBox[{"Sinh", "[", 
                    FractionBox["\[Theta]", "L"], "]"}], "2"]}]}], "}"}]}], 
                    "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"Schwarzschild-AdS n=4\"\>", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    FractionBox[
                    RowBox[{"2", " ", "M"}], "r"], "-", 
                    RowBox[{"k", " ", 
                    SuperscriptBox["r", "2"]}]}], ",", "0", ",", "0", ",", 
                    "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{"2", " ", "M"}], "r"], "+", 
                    RowBox[{"k", " ", 
                    SuperscriptBox["r", "2"]}]}]], ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    SuperscriptBox["r", "2"], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0", ",", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], 
                    "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"Static BTZ n=3\"\>", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"M", "-", 
                    SuperscriptBox["r", "2"]}], ",", "0", ",", "0"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "M"}], "+", 
                    SuperscriptBox["r", "2"]}]], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    SuperscriptBox["r", "2"]}], "}"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\<\"Rindler-AdS n=3\"\>", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox["r", "2"]}], "+", 
                    SuperscriptBox["rh", "2"]}], ",", "0", ",", "0"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    FractionBox["1", 
                    RowBox[{
                    SuperscriptBox["r", "2"], "-", 
                    SuperscriptBox["rh", "2"]}]], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    SuperscriptBox["r", "2"]}], "}"}]}], "}"}]}], "}"}]}], 
                    "}"}]}]}
                    },
                    DefaultBaseStyle->"Column",
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"ScalarWaveEquation`metricDictionary\"\
\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->6], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\" Dictionary with spacetime names and their metrics. \
Options of spacetimes are: 'Minkowski Spherical n=4', 'Schwarzschild \
n=4','Kerr n=4', 'static spherically','AdS Global n=4','Rindler-AdS \
n=4','Schwarzschild-AdS n=4','Static BTZ n=3','Rindler-AdS n=3.\"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{10., {3., 7.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{10., {3., 7.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[
   Association[
   "ObjectType" -> "Symbol", "Usage" -> 
    " Dictionary with spacetime names and their metrics. Options of \
spacetimes are: 'Minkowski Spherical n=4', 'Schwarzschild n=4','Kerr n=4', \
'static spherically','AdS Global n=4','Rindler-AdS n=4','Schwarzschild-AdS \
n=4','Static BTZ n=3','Rindler-AdS n=3.", "Documentation" -> None, 
    "OwnValues" -> 
    Information`InformationValueForm[
     OwnValues, ScalarWaveEquation`metricDictionary, {
      ScalarWaveEquation`metricDictionary -> {{
         "Minkowski Spherical n=4", {{-1, 0, 0, 0}, {0, 1, 0, 0}, {
           0, 0, ScalarWaveEquation`r^2, 0}, {
           0, 0, 0, ScalarWaveEquation`r^2 
            Sin[ScalarWaveEquation`\[Theta]]^2}}}, {
         "Schwarzschild n=4", {{-1 + 
            2 (ScalarWaveEquation`M/ScalarWaveEquation`r), 0, 0, 0}, {
           0, (1 - 2 (ScalarWaveEquation`M/ScalarWaveEquation`r))^(-1), 0, 
            0}, {0, 0, ScalarWaveEquation`r^2, 0}, {
           0, 0, 0, ScalarWaveEquation`r^2 
            Sin[ScalarWaveEquation`\[Theta]]^2}}}, {
         "Kerr n=4", {{
           1 - (2 ScalarWaveEquation`M) (ScalarWaveEquation`r/(
             ScalarWaveEquation`r^2 + 
             ScalarWaveEquation`a^2 Cos[ScalarWaveEquation`\[Theta]]^2)), 0, 
            0, (((((-2) ScalarWaveEquation`a) ScalarWaveEquation`M) 
              ScalarWaveEquation`r)/(ScalarWaveEquation`r^2 + 
             ScalarWaveEquation`a^2 Cos[ScalarWaveEquation`\[Theta]]^2)) 
            Sin[ScalarWaveEquation`\[Theta]]^2}, {
           0, (ScalarWaveEquation`a^2 - (2 ScalarWaveEquation`M) 
              ScalarWaveEquation`r + ScalarWaveEquation`r^2)^(-1) (
             ScalarWaveEquation`r^2 + 
             ScalarWaveEquation`a^2 Cos[ScalarWaveEquation`\[Theta]]^2), 0, 
            0}, {0, 0, ScalarWaveEquation`r^2 + 
            ScalarWaveEquation`a^2 Cos[ScalarWaveEquation`\[Theta]]^2, 
            0}, {(((((-2) ScalarWaveEquation`a) ScalarWaveEquation`M) 
              ScalarWaveEquation`r)/(ScalarWaveEquation`r^2 + 
             ScalarWaveEquation`a^2 Cos[ScalarWaveEquation`\[Theta]]^2)) 
            Sin[ScalarWaveEquation`\[Theta]]^2, 0, 0, 
            Sin[ScalarWaveEquation`\[Theta]]^2 (ScalarWaveEquation`a^2 + 
             ScalarWaveEquation`r^2 + ((((2 ScalarWaveEquation`a^2) 
                 ScalarWaveEquation`M) ScalarWaveEquation`r)/(
               ScalarWaveEquation`r^2 + 
               ScalarWaveEquation`a^2 Cos[ScalarWaveEquation`\[Theta]]^2)) 
              Sin[ScalarWaveEquation`\[Theta]]^2)}}}, {
         "static spherically symmetric n=4", {{-
            ScalarWaveEquation`f[ScalarWaveEquation`r], 0, 0, 0}, {
           0, ScalarWaveEquation`f[ScalarWaveEquation`r]^(-1), 0, 0}, {
           0, 0, ScalarWaveEquation`r^2, 0}, {
           0, 0, 0, ScalarWaveEquation`r^2 
            Sin[ScalarWaveEquation`\[Theta]]^2}}}, {
         "AdS Global n=4", {{-1 - ScalarWaveEquation`r^2, 0, 0, 0}, {
           0, (1 + ScalarWaveEquation`r^2)^(-1), 0, 0}, {
           0, 0, ScalarWaveEquation`r^2, 0}, {
           0, 0, 0, ScalarWaveEquation`r^2 
            Sin[ScalarWaveEquation`\[Theta]]^2}}}, {
         "Rindler-AdS n=4", {{((-1) ScalarWaveEquation`L^(-2)) 
            ScalarWaveEquation`r^2, 0, 0, 0}, {
           0, (1 + ScalarWaveEquation`L^(-2) ScalarWaveEquation`r^2)^(-1), 0, 
            0}, {0, 0, 1 + ScalarWaveEquation`L^(-2) ScalarWaveEquation`r^2, 
            0}, {0, 0, 
            0, (ScalarWaveEquation`L^2 (1 + 
              ScalarWaveEquation`L^(-2) ScalarWaveEquation`r^2)) 
            Sinh[ScalarWaveEquation`L^(-1) 
               ScalarWaveEquation`\[Theta]]^2}}}, {
         "Schwarzschild-AdS n=4", {{-1 + 
            2 (ScalarWaveEquation`M/ScalarWaveEquation`r) - 
            ScalarWaveEquation`k ScalarWaveEquation`r^2, 0, 0, 0}, {
           0, (1 - 2 (ScalarWaveEquation`M/ScalarWaveEquation`r) + 
             ScalarWaveEquation`k ScalarWaveEquation`r^2)^(-1), 0, 0}, {
           0, 0, ScalarWaveEquation`r^2, 0}, {
           0, 0, 0, ScalarWaveEquation`r^2 
            Sin[ScalarWaveEquation`\[Theta]]^2}}}, {
         "Static BTZ n=3", {{
           ScalarWaveEquation`M - ScalarWaveEquation`r^2, 0, 0}, {
           0, (-ScalarWaveEquation`M + ScalarWaveEquation`r^2)^(-1), 0}, {
           0, 0, ScalarWaveEquation`r^2}}}, {
         "Rindler-AdS n=3", {{-ScalarWaveEquation`r^2 + 
            ScalarWaveEquation`rh^2, 0, 0}, {
           0, (ScalarWaveEquation`r^2 - ScalarWaveEquation`rh^2)^(-1), 0}, {
           0, 0, ScalarWaveEquation`r^2}}}}}], "UpValues" -> None, 
    "DownValues" -> None, "SubValues" -> None, "DefaultValues" -> None, 
    "NValues" -> None, "FormatValues" -> None, "Options" -> None, 
    "Attributes" -> {}, "FullName" -> "ScalarWaveEquation`metricDictionary"], 
   False]]], "Output",
 CellChangeTimes->{{3.8119700305336123`*^9, 3.811970062154937*^9}, 
   3.811971069256141*^9, 3.811971584604364*^9, 3.8119716213537145`*^9, 
   3.8119717056067915`*^9, 3.8119717382915344`*^9, 3.811972000306496*^9, {
   3.8119720749027605`*^9, 3.811972082440849*^9}, 3.811972203914669*^9, 
   3.81197238145227*^9, 3.81197707246419*^9, 3.8119771031646185`*^9, 
   3.811977543644703*^9, {3.811978338672819*^9, 3.811978343588258*^9}, 
   3.812036774758701*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"26063d99-7d88-4e8b-8615-27f9f121b740"]
}, Open  ]],

Cell["So, we have:", "Text",
 CellChangeTimes->{{3.811970081126966*^9, 
  3.8119700831182976`*^9}},ExpressionUUID->"ee394dc0-9609-43f1-8980-\
b78e7c0c20d0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScalarWaveEquation", "[", 
  RowBox[{
   RowBox[{"\"\<spacetime\>\"", "\[Rule]", "\"\<Static BTZ n=3\>\""}], ",", 
   " ", 
   RowBox[{"\"\<ansatz\>\"", "\[Rule]", 
    RowBox[{"{", " ", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", "t", " "}]], 
      ",", 
      RowBox[{"R", "[", "r", "]"}], ",", " ", 
      RowBox[{"Y", "[", "\[Theta]", "]"}]}], "}"}]}], " ", ",", 
   RowBox[{"\"\<mass\>\"", "\[Rule]", "m"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8119685333957176`*^9, 3.811968535318429*^9}, {
   3.811968895771268*^9, 3.811968980786183*^9}, 3.811969219764987*^9, {
   3.8119695516645184`*^9, 3.811969609304295*^9}, {3.8119722171022396`*^9, 
   3.8119722250315475`*^9}, {3.8119725257592573`*^9, 
   3.8119725259072113`*^9}, {3.8119775563806477`*^9, 3.811977557566847*^9}, 
   3.811978099067834*^9, {3.8119783482301674`*^9, 3.8119783492135334`*^9}, 
   3.8119784298614693`*^9, {3.817564207610851*^9, 3.8175642115355053`*^9}, {
   3.8175642496335344`*^9, 3.8175642695203056`*^9}, {3.8175676576057787`*^9, 
   3.817567668290753*^9}, {3.817568612036672*^9, 3.817568612561668*^9}, {
   3.8175687224921274`*^9, 3.8175687228321238`*^9}, {3.817568753810132*^9, 
   3.8175687548420506`*^9}, {3.8175692541544037`*^9, 
   3.8175692664337144`*^9}, {3.8175697455997205`*^9, 3.8175697468935776`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"f53db22d-5f18-4afc-b625-d4908c1e6a40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox["m", "2"]}], "+", 
  FractionBox[
   SuperscriptBox["\[Omega]", "2"], 
   RowBox[{
    RowBox[{"-", "M"}], "+", 
    SuperscriptBox["r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"M", "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["r", "2"]}]}], ")"}]}], " ", 
     RowBox[{
      SuperscriptBox["R", "\[Prime]",
       MultilineFunction->None], "[", "r", "]"}]}], "+", 
    RowBox[{"r", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "M"}], "+", 
       SuperscriptBox["r", "2"]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["R", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "r", "]"}]}]}], 
   RowBox[{"r", " ", 
    RowBox[{"R", "[", "r", "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["Y", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "\[Theta]", "]"}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"Y", "[", "\[Theta]", "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.8175687601419725`*^9, 3.817568765824878*^9}, 
   3.817568828668247*^9, 3.8175688663732643`*^9, 3.817568952620242*^9, 
   3.817569133650348*^9, {3.8175691669133916`*^9, 3.8175691681036787`*^9}, {
   3.8175692462161083`*^9, 3.8175692966739173`*^9}, 3.8175696713909063`*^9, 
   3.8175697391505237`*^9, {3.8175698144189224`*^9, 3.8175698183231497`*^9}, 
   3.817570254986624*^9, 3.8175709257612753`*^9, 3.8175710207240906`*^9, 
   3.8175710582788363`*^9, 3.817572475298341*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"78683a37-6681-433d-af7a-a450a84c19fc"]
}, Open  ]],

Cell["\<\
For a non-diagonal metric, it doesn\[CloseCurlyQuote]t automatically simplify \
the equation, that could take some time...\
\>", "Text",
 CellChangeTimes->{{3.8119762902448864`*^9, 3.811976299765672*^9}, {
  3.811978583753416*^9, 
  3.81197861871799*^9}},ExpressionUUID->"a9bd6ada-192c-468c-a31d-\
e766151e98a5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScalarWaveEquation", "[", 
  RowBox[{
   RowBox[{"\"\<spacetime\>\"", "\[Rule]", "\"\<Kerr n=4\>\""}], ",", " ", 
   RowBox[{"\"\<ansatz\>\"", "\[Rule]", 
    RowBox[{"{", " ", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", "t", " "}]], 
      ",", 
      RowBox[{"R", "[", "r", "]"}], ",", " ", 
      RowBox[{"Y", "[", 
       RowBox[{"\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}], "}"}]}]}], " ", 
  "]"}]], "Input",
 CellChangeTimes->{{3.811976307111368*^9, 3.8119763196175175`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"0c3d351d-9951-484b-850c-ce7bcafd6623"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               SuperscriptBox["a", "2"], " ", 
               SuperscriptBox["\[Omega]", "2"], " ", 
               SuperscriptBox[
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
               SqrtBox[
                FractionBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["r", "2"], "+", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]}], ")"}], "2"], " ", 
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox[
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], "2"]}], "+", 
                    TemplateBox[{"7"},
                    "OutputSizeLimit`Skeleton"], "+", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]}], ")"}]}], 
                 RowBox[{
                  SuperscriptBox["a", "2"], "-", 
                  RowBox[{"2", " ", "M", " ", "r"}], "+", 
                  SuperscriptBox["r", "2"]}]]]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
               RowBox[{
                SuperscriptBox["r", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "-", 
               FractionBox[
                RowBox[{"2", " ", 
                 SuperscriptBox["a", "2"], " ", "M", " ", "r", " ", 
                 SuperscriptBox[
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton"], "2"]}], 
                RowBox[{
                 SuperscriptBox["r", "2"], "+", 
                 RowBox[{
                  SuperscriptBox["a", "2"], " ", 
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton"]}]}]], "-", 
               FractionBox[
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"], 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"]], "-", 
               FractionBox[
                RowBox[{"8", " ", 
                 SuperscriptBox["a", "2"], " ", 
                 SuperscriptBox["M", "2"], " ", 
                 SuperscriptBox["r", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["r", "2"], "+", 
                   TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]}], ")"}], "2"]], "+", 
               FractionBox[
                RowBox[{"2", " ", 
                 SuperscriptBox["a", "2"], " ", "M", " ", "r", " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], 
                RowBox[{
                 SuperscriptBox["r", "2"], "+", 
                 RowBox[{
                  SuperscriptBox["a", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]]}]]}], "-", 
            FractionBox[
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton"], 
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton"]], "-", 
            FractionBox[
             RowBox[{"2", " ", 
              TemplateBox[{"5"},
               "OutputSizeLimit`Skeleton"], " ", 
              SqrtBox[
               FractionBox[
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"], 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"]]]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r", "2"], "+", 
                RowBox[{
                 SuperscriptBox["a", "2"], " ", 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"]}]}], ")"}], " ", 
              RowBox[{"(", 
               TemplateBox[{"1"},
                "OutputSizeLimit`Skeleton"], ")"}]}]]}], 
           SqrtBox[
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["r", "2"], "+", 
                 RowBox[{
                  SuperscriptBox["a", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
               "2"], " ", 
              RowBox[{"If", "[", 
               TemplateBox[{"1"},
                "OutputSizeLimit`Skeleton"], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["a", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["r", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "-", 
                FractionBox[
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"], 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"]], "-", 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"], "-", 
                FractionBox[
                 RowBox[{"8", " ", 
                  SuperscriptBox["a", "2"], " ", 
                  SuperscriptBox["M", "2"], " ", 
                  SuperscriptBox["r", "2"], " ", 
                  SuperscriptBox[
                   TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], "4"]}], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], ")"}], "2"]], "+", 
                FractionBox[
                 RowBox[{"2", " ", 
                  SuperscriptBox["a", "2"], " ", "M", " ", "r", " ", 
                  SuperscriptBox[
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], "4"]}], 
                 RowBox[{
                  SuperscriptBox["r", "2"], "+", 
                  RowBox[{
                   SuperscriptBox["a", "2"], " ", 
                   SuperscriptBox[
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], "2"]}]}]]}], ")"}]}], 
             RowBox[{
              SuperscriptBox["a", "2"], "-", 
              RowBox[{"2", " ", "M", " ", "r"}], "+", 
              SuperscriptBox["r", "2"]}]]]], "+", 
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"2", " ", 
               TemplateBox[{"3"},
                "OutputSizeLimit`Skeleton"], " ", 
               RowBox[{
                SuperscriptBox["R", "\[Prime]",
                 MultilineFunction->None], "[", "r", "]"}]}], 
              SuperscriptBox[
               RowBox[{"(", 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"], ")"}], "2"]]}], "+", 
            TemplateBox[{"240"},
             "OutputSizeLimit`Skeleton"], "+", 
            FractionBox[
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton"], 
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton"]]}], 
           RowBox[{
            RowBox[{"R", "[", "r", "]"}], " ", 
            SqrtBox[
             FractionBox[
              TemplateBox[{"1"},
               "OutputSizeLimit`Skeleton"], 
              RowBox[{
               SuperscriptBox["a", "2"], "-", 
               RowBox[{"2", " ", "M", " ", "r"}], "+", 
               SuperscriptBox["r", "2"]}]]]}]], "+", 
          FractionBox[
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"], 
           RowBox[{
            SqrtBox[
             FractionBox[
              TemplateBox[{"1"},
               "OutputSizeLimit`Skeleton"], 
              RowBox[{
               SuperscriptBox["a", "2"], "-", 
               RowBox[{"2", " ", "M", " ", "r"}], "+", 
               SuperscriptBox["r", "2"]}]]], " ", 
            RowBox[{"Y", "[", 
             RowBox[{"\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}]]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{48.75, {3., 7.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{39., {1., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 7, 20325279448952587279, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{46.5, {1., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 7, 20325279448952587279, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{33., {1., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 7, 20325279448952587279, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{58.5, {1., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[20325279448952587279 === $SessionID, 
   Out[7], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{3.811977069910266*^9, 3.811977286343986*^9, 
  3.8119775469888406`*^9, 3.8119781427140417`*^9, 3.8119782721282797`*^9, 
  3.811978626741529*^9, 3.812036690002738*^9, 3.812036770992573*^9, 
  3.8175724780670953`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"df481b78-8a60-41f6-a386-33712084ca83"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["By giving the diagonal of a diagonal metric.",
 FontColor->RGBColor[
  0.7764705882352941, 0., 0.7764705882352941]]], "Subsubsection",
 CellChangeTimes->{{3.811970166494561*^9, 3.8119701726135197`*^9}, {
  3.8119702133981543`*^9, 
  3.811970234973811*^9}},ExpressionUUID->"b455d6bf-146a-4c23-9e50-\
b145175e592c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScalarWaveEquation", "[", 
  RowBox[{
   RowBox[{"\"\<diagonal_metric\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"2", "M"}], "r"], "+", 
         RowBox[{"k", " ", 
          SuperscriptBox["r", "2"]}]}], ")"}]}], ",", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"2", "M"}], "r"], "+", 
         RowBox[{"k", " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], 
       RowBox[{"-", "1"}]], ",", 
      SuperscriptBox["r", "2"], ",", 
      RowBox[{
       SuperscriptBox["r", "2"], 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], " ", ",", 
   " ", 
   RowBox[{"\"\<ansatz\>\"", "\[Rule]", 
    RowBox[{"{", " ", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", "t", " "}]], 
      ",", 
      RowBox[{"R", "[", "r", "]"}], ",", " ", 
      RowBox[{"Y", "[", 
       RowBox[{"\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}], "}"}]}], ",", ",", 
   RowBox[{"\"\<mass\>\"", "\[Rule]", "m"}], ",", 
   RowBox[{"\"\<coordinates\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8119675617618575`*^9, 3.8119675971470804`*^9}, {
  3.8119697886422205`*^9, 3.8119698446635365`*^9}, {3.817572494727231*^9, 
  3.8175725149998875`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"bcdc8425-9e95-4297-859e-a2c30e99b5f9"],

Cell[BoxData[
 RowBox[{"ScalarWaveEquation", "[", 
  RowBox[{
   RowBox[{"\<\"diagonal_metric\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       FractionBox[
        RowBox[{"2", " ", "M"}], "r"], "-", 
       RowBox[{"k", " ", 
        SuperscriptBox["r", "2"]}]}], ",", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"], "+", 
        RowBox[{"k", " ", 
         SuperscriptBox["r", "2"]}]}]], ",", 
      SuperscriptBox["r", "2"], ",", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], ",", 
   RowBox[{"\<\"ansatz\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "t", " ", "\[Omega]"}]], ",", 
      RowBox[{"R", "[", "r", "]"}], ",", 
      RowBox[{"Y", "[", 
       RowBox[{"\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}], "}"}]}], ",", 
   "Null", ",", 
   RowBox[{"\<\"mass\"\>", "\[Rule]", "m"}], ",", 
   RowBox[{"\<\"coordinates\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.8119675769277306`*^9, 3.811967597723176*^9}, 
   3.8119676321315193`*^9, {3.8119698361821575`*^9, 3.811969847355091*^9}, 
   3.8120366974574594`*^9, 3.8120367693612475`*^9, {3.817572495486909*^9, 
   3.8175725156238565`*^9}},
 CellLabel->"Out[9]=",ExpressionUUID->"9f6da46a-3e33-4e19-8431-3def23ff6baf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["By giving the full metric.",
 FontColor->RGBColor[
  0.7764705882352941, 0., 0.7764705882352941]]], "Subsubsection",
 CellChangeTimes->{{3.811970166494561*^9, 3.8119701726135197`*^9}, {
  3.8119702133981543`*^9, 
  3.811970249061366*^9}},ExpressionUUID->"3151f513-9e6a-44a8-a089-\
b73c4f240f05"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScalarWaveEquation", "[", 
  RowBox[{
   RowBox[{"\"\<metric\>\"", "\[Rule]", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"f", "[", "r", "]"}]}], ",", 
       FractionBox["1", 
        RowBox[{"f", "[", "r", "]"}]], ",", 
       SuperscriptBox["r", "2"], ",", 
       RowBox[{
        SuperscriptBox["r", "2"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], "]"}]}], " ",
    ",", " ", 
   RowBox[{"\"\<ansatz\>\"", "\[Rule]", 
    RowBox[{"{", " ", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", "t", " "}]], 
      ",", 
      RowBox[{"R", "[", "r", "]"}], ",", " ", 
      RowBox[{"Y", "[", 
       RowBox[{"\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8119659577849593`*^9, 3.811965964801936*^9}, {
   3.8119662128678055`*^9, 3.8119662295224476`*^9}, 3.8119662605696754`*^9, {
   3.811966315695868*^9, 3.8119663336814976`*^9}, {3.8119668066941414`*^9, 
   3.811966875422715*^9}, {3.811966960006397*^9, 3.8119669682442164`*^9}, {
   3.8119672879749947`*^9, 3.8119672992907543`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"f8ea01f3-9ece-4769-88b0-9ab56561c2f7"],

Cell[BoxData[
 TemplateBox[{
  "ScalarWaveEquation", "invCoords", 
   "\"\\n\\t\\tinvalid coordinates. Please check the arguments \
given.\\n\\t\"", 2, 10, 2, 20325279448952587279, "New Kernel", 
   "ScalarWaveEquation`ScalarWaveEquation"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.817572520824232*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"d1970fe9-26f6-4d69-8536-7e0ef5cd7f12"]
}, Open  ]],

Cell["But don' t forget the coordinates! ", "Text",
 CellChangeTimes->{{3.8175725317915688`*^9, 
  3.817572541124694*^9}},ExpressionUUID->"dff8cae5-c15d-4136-8554-\
c02b7b41f7f7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["The other options: ansatz, coordinates, Lorentzian.",
 FontColor->RGBColor[
  0.49411764705882355`, 0.13333333333333333`, 
   0.07058823529411765]]], "Section",
 CellChangeTimes->{{3.8119699331260815`*^9, 3.811970020216326*^9}, {
   3.811970074069496*^9, 3.8119700773024535`*^9}, {3.8119701808606973`*^9, 
   3.81197018950849*^9}, {3.8119725007500496`*^9, 3.811972510171292*^9}, {
   3.811972809033696*^9, 3.8119728533628626`*^9}, {3.811972989033469*^9, 
   3.8119729960012045`*^9}, 
   3.8119730746203375`*^9},ExpressionUUID->"e2fb7e8d-596b-40e4-8729-\
c6b66b7d39d2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "[", "ScalarWaveEquation", "]"}]], "Input",
 CellChangeTimes->{{3.8119730005224257`*^9, 3.8119730046130686`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"cee8dfe0-8221-401e-96f3-e4a3b3d1d492"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"spacetime\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"diagonal_metric\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"metric\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"coordinates\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"Lorentzian\"\>", "\[Rule]", "\<\"True\"\>"}], ",", 
   RowBox[{"\<\"ansatz\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}], ",", 
   RowBox[{"\<\"sol\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8119731101770716`*^9, 3.8119732012320127`*^9, 
  3.811973245216349*^9, 3.811973546433095*^9, 3.812036714616501*^9, 
  3.8175725445166445`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"3dfe0e60-fdcc-4c1c-80c3-61ec0b5cbadb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["The ansatz.",
 FontColor->RGBColor[
  0.7764705882352941, 0., 0.7764705882352941]]], "Subsubsection",
 CellChangeTimes->{{3.811970166494561*^9, 3.8119701726135197`*^9}, {
  3.8119702133981543`*^9, 3.811970249061366*^9}, {3.811974261263875*^9, 
  3.811974263422903*^9}},ExpressionUUID->"9776e87f-f443-407f-8709-\
22b47f7944b0"],

Cell["One does not have to chose an ansatz:", "Text",
 CellChangeTimes->{{3.8119700866303205`*^9, 3.811970123621664*^9}, {
  3.8119723952658024`*^9, 3.811972418474102*^9}, {3.811972512554211*^9, 
  3.811972514081403*^9}},ExpressionUUID->"6cedc09f-6b41-453f-86f7-\
f23cf893a6e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScalarWaveEquation", "[", 
  RowBox[{
   RowBox[{"\"\<spacetime\>\"", "\[Rule]", "\"\<Static BTZ n=3\>\""}], ",", 
   RowBox[{"\"\<sol\>\"", "\[Rule]", "\[CapitalPsi]"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8119701064236207`*^9, {3.817572571764385*^9, 3.817572585875967*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"58911ab8-7036-4531-a413-7e0d3205ded4"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[CapitalPsi]", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "2"}], "}"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"{", 
      RowBox[{"t", ",", "r", ",", "\[Theta]"}], "}"}], "]"}], "+", 
    RowBox[{"r", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}], " ", 
        RowBox[{
         SuperscriptBox["\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0"}], "}"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"{", 
          RowBox[{"t", ",", "r", ",", "\[Theta]"}], "}"}], "]"}]}], "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M"}], "+", 
          SuperscriptBox["r", "2"]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2", ",", "0"}], "}"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"{", 
          RowBox[{"t", ",", "r", ",", "\[Theta]"}], "}"}], "]"}]}]}], 
      ")"}]}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[CapitalPsi]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0", ",", "0"}], "}"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"{", 
     RowBox[{"t", ",", "r", ",", "\[Theta]"}], "}"}], "]"}], 
   RowBox[{"M", "-", 
    SuperscriptBox["r", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.817572580978055*^9, 3.817572586498269*^9}},
 CellLabel->"Out[14]=",ExpressionUUID->"8f0e29ba-f0ed-4be6-a45b-e111e6fd551a"]
}, Open  ]],

Cell["\<\
But using an ansatz can make it so much simpler right? Well, assuming \
separation of variables, one should write the separating functions separated, \
as shown before. Let\[CloseCurlyQuote]s see the wave equation on the \
four-dimensional Minkowski spacetime with spherical coordinates, assuming \
separation of variables:\
\>", "Text",
 CellChangeTimes->{{3.8119735967526894`*^9, 
  3.8119737369279547`*^9}},ExpressionUUID->"01457409-7a85-401e-be08-\
7913f4e863a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScalarWaveEquation", "[", 
  RowBox[{
   RowBox[{
   "\"\<spacetime\>\"", "\[Rule]", "\"\<Minkowski Spherical n=4\>\""}], ",", 
   " ", 
   RowBox[{"\"\<ansatz\>\"", "\[Rule]", 
    RowBox[{"{", " ", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", "t", " "}]], 
      ",", 
      RowBox[{"R", "[", "r", "]"}], ",", " ", 
      RowBox[{"Y", "[", 
       RowBox[{"\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}], "}"}]}]}], " ", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8119737404657946`*^9, 3.8119737570661726`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"4c7d61e4-cc4c-4497-9ee4-97b2dca5fe94"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[Omega]", "2"], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{
      SuperscriptBox["R", "\[Prime]",
       MultilineFunction->None], "[", "r", "]"}]}], "+", 
    RowBox[{"r", " ", 
     RowBox[{
      SuperscriptBox["R", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "r", "]"}]}]}], 
   RowBox[{"r", " ", 
    RowBox[{"R", "[", "r", "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], " ", 
     RowBox[{
      SuperscriptBox["Y", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
     RowBox[{
      SuperscriptBox["Y", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["Y", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"Y", "[", 
     RowBox[{"\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}]]}]], "Output",
 CellChangeTimes->{3.8119737591511817`*^9, 3.812036719717537*^9, 
  3.812036764958146*^9, 3.817572594084615*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"696a5910-21f7-4b2a-8a09-0e2ab54d8a90"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["The coordinates.",
 FontColor->RGBColor[
  0.7764705882352941, 0., 0.7764705882352941]]], "Subsubsection",
 CellChangeTimes->{{3.811970166494561*^9, 3.8119701726135197`*^9}, {
  3.8119702133981543`*^9, 3.811970249061366*^9}, {3.811974261263875*^9, 
  3.811974277342865*^9}},ExpressionUUID->"5e8aff79-3396-43df-8d31-\
ba9d00b7e64c"],

Cell["\<\
The default coordinates are  {t,r,\[Theta],\[CurlyPhi]}. If the metric is \
written in other coordinates, or is higher dimensional, the coordinates must \
be specified. 
Let\[CloseCurlyQuote]s see the five dimensional Minkowski spacetime as an \
example:\
\>", "Text",
 CellChangeTimes->{{3.81197253642699*^9, 3.8119726201443624`*^9}, {
  3.8119727051771045`*^9, 
  3.8119727203680253`*^9}},ExpressionUUID->"6dcb0e6e-f501-4b1b-af2d-\
802269886877"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScalarWaveEquation", "[", 
  RowBox[{
   RowBox[{"\"\<metric\>\"", "\[Rule]", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", "1"}], " ", 
      "}"}], "]"}]}], " ", ",", " ", 
   RowBox[{"\"\<coordinates\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}]}], ",", 
   RowBox[{"\"\<sol\>\"", "\[Rule]", "\[CapitalPsi]"}], ",", 
   RowBox[{"\"\<mass\>\"", "\[Rule]", "m"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8119726416023784`*^9, 3.8119726420345545`*^9}, {
  3.8119727275786295`*^9, 3.811972780162851*^9}, {3.81757261469911*^9, 
  3.817572645147276*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"acb647e3-400a-4dac-bbaa-5de2eda155a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["m", "2"]}], " ", 
   RowBox[{"\[CapitalPsi]", "[", 
    RowBox[{"{", 
     RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], 
    "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[CapitalPsi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}], "}"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"{", 
    RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], "]"}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[CapitalPsi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "2", ",", "0"}], "}"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"{", 
    RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], "]"}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[CapitalPsi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "2", ",", "0", ",", "0"}], "}"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"{", 
    RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], "]"}], 
  "+", 
  RowBox[{
   SuperscriptBox["\[CapitalPsi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2", ",", "0", ",", "0", ",", "0"}], "}"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"{", 
    RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], "]"}], 
  "-", 
  RowBox[{
   SuperscriptBox["\[CapitalPsi]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"{", 
    RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], "]"}]}]
  ], "Output",
 CellChangeTimes->{
  3.8119727805479565`*^9, 3.8120367216962323`*^9, 3.8120367667276945`*^9, {
   3.8175726236790113`*^9, 3.8175726456892767`*^9}},
 CellLabel->"Out[21]=",ExpressionUUID->"1f9938b1-47cf-47dd-83d4-aa9ba8fa82e8"]
}, Open  ]],

Cell["Example of plane wave eigenmodes :", "Text",
 CellChangeTimes->{{3.811975261706892*^9, 
  3.811975266861676*^9}},ExpressionUUID->"cd96fb4b-83b4-4ee2-9622-\
245ea37be5f1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"weq", "=", 
  RowBox[{
   RowBox[{"ScalarWaveEquation", "[", 
    RowBox[{
     RowBox[{"\"\<metric\>\"", "\[Rule]", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], " ", ",", " ", 
     RowBox[{"\"\<coordinates\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"t", ",", "x"}], "}"}]}], ",", 
     RowBox[{"\"\<ansatz\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "v", " ", "t"}]], ",", 
        RowBox[{"X", "[", "x", "]"}]}], "}"}]}]}], "]"}], "/.", 
   RowBox[{"m", "\[Rule]", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.811973166849699*^9, 3.8119731862902193`*^9}, {
   3.811973274881627*^9, 3.8119732757618847`*^9}, {3.8119734557529774`*^9, 
   3.8119734611124945`*^9}, {3.811973549514805*^9, 3.8119735767858686`*^9}, {
   3.8119737826447964`*^9, 3.8119738031769714`*^9}, {3.8119739393152447`*^9, 
   3.811973951917584*^9}, {3.8119740268686547`*^9, 3.8119740299378476`*^9}, {
   3.811974228139526*^9, 3.8119742293757677`*^9}, 3.81197496011028*^9, {
   3.8119751094568386`*^9, 3.8119751097676105`*^9}, {3.8119752348963394`*^9, 
   3.811975237597624*^9}, {3.811975276713647*^9, 3.811975276983507*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"80f97d21-a0be-49f7-9f3e-fb8d998029ca"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["v", "2"], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["X", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], 
   RowBox[{"X", "[", "x", "]"}]]}]], "Output",
 CellChangeTimes->{
  3.8119740837670965`*^9, {3.811974214108924*^9, 3.81197422994621*^9}, 
   3.811974960720271*^9, 3.8119751109492717`*^9, 3.811975238349037*^9, 
   3.812036723903557*^9, 3.8120367618194885`*^9, {3.8175726390149126`*^9, 
   3.817572647653051*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"8d504230-bdd0-48e6-a1b7-49ae7e069142"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"weq", "\[Equal]", "0"}], ",", 
   RowBox[{"X", "[", "x", "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.81197420856402*^9, 3.811974237113269*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"b35908dc-1fa8-4aef-982a-4fcf84bb26d6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"X", "[", "x", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      TemplateBox[{"1"},
       "C"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"v", " ", "x"}], "]"}]}], "+", 
     RowBox[{
      TemplateBox[{"2"},
       "C"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"v", " ", "x"}], "]"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.8119742185527377`*^9, 3.8119742373585796`*^9}, 
   3.811974979543181*^9, 3.81197511231584*^9, 3.811975239763444*^9, 
   3.812036726574586*^9, 3.8175726491457295`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"571e6e18-fcfa-4bc1-8dff-538236468cba"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Lorentzian versus Riemannian.",
 FontColor->RGBColor[
  0.7764705882352941, 0., 0.7764705882352941]]], "Subsubsection",
 CellChangeTimes->{{3.811970166494561*^9, 3.8119701726135197`*^9}, {
  3.8119702133981543`*^9, 3.811970249061366*^9}, {3.811974261263875*^9, 
  3.8119743032389536`*^9}},ExpressionUUID->"5120552f-77fa-44b7-9e76-\
e373c492ec85"],

Cell["\<\
It assumes a Lorentzian spacetime. For a Riemannian spacetime, just specify \
it by setting the option \[OpenCurlyDoubleQuote]Lorentzian\
\[CloseCurlyDoubleQuote] to False. \
\>", "Text",
 CellChangeTimes->{{3.8119728740102606`*^9, 3.811972892272911*^9}, {
  3.8119730268194532`*^9, 3.811973047571316*^9}, {3.811973090876501*^9, 
  3.8119731555202217`*^9}, {3.811974007513054*^9, 3.811974017152553*^9}, {
  3.8119752606390076`*^9, 3.8119752870778856`*^9}, {3.8175728767866635`*^9, 
  3.8175728782579665`*^9}},ExpressionUUID->"e68541f0-d271-4d12-96a1-\
5f260f296521"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"weq", "=", 
  RowBox[{"ScalarWaveEquation", "[", 
   RowBox[{
    RowBox[{"\"\<metric\>\"", "\[Rule]", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]}], " ", ",", 
    " ", 
    RowBox[{"\"\<coordinates\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], ",", 
    RowBox[{"\"\<ansatz\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", "t"}]], ",", 
       RowBox[{"X", "[", "x", "]"}], ",", 
       RowBox[{"Y", "[", "y", "]"}], ",", 
       RowBox[{"Z", "[", "z", "]"}]}], "}"}]}], ",", 
    RowBox[{"\"\<Lorentzian\>\"", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.811973166849699*^9, 3.8119731862902193`*^9}, {
   3.811973274881627*^9, 3.8119732757618847`*^9}, {3.8119734557529774`*^9, 
   3.8119734611124945`*^9}, {3.811973549514805*^9, 3.8119735767858686`*^9}, {
   3.8119737826447964`*^9, 3.8119738031769714`*^9}, {3.8119739393152447`*^9, 
   3.811973951917584*^9}, {3.8119740268686547`*^9, 3.8119740299378476`*^9}, {
   3.811974228139526*^9, 3.8119742293757677`*^9}, 3.81197496011028*^9, {
   3.8119751094568386`*^9, 3.8119751097676105`*^9}, {3.8119752348963394`*^9, 
   3.811975237597624*^9}, {3.811975276713647*^9, 3.811975276983507*^9}, {
   3.811975323919388*^9, 3.8119753804140615`*^9}, {3.8175726538312197`*^9, 
   3.8175726559082856`*^9}, {3.8175727595755286`*^9, 3.817572760307083*^9}, {
   3.8175728686970263`*^9, 3.817572869443101*^9}, {3.8175729085034494`*^9, 
   3.817572913386989*^9}, {3.817573044703111*^9, 3.8175730525916424`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"1447f64f-2520-4b61-9384-38fc20a1b1b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox["\[Omega]", "2"]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["X", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], 
   RowBox[{"X", "[", "x", "]"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["Y", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "y", "]"}], 
   RowBox[{"Y", "[", "y", "]"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["Z", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "z", "]"}], 
   RowBox[{"Z", "[", "z", "]"}]]}]], "Output",
 CellChangeTimes->{{3.8119753552949224`*^9, 3.811975381468295*^9}, 
   3.8120367283698015`*^9, 3.812036760995406*^9, 3.817572656386112*^9, 
   3.817572760909622*^9, {3.817572869738087*^9, 3.8175729136475353`*^9}, {
   3.817573032601403*^9, 3.8175730529075975`*^9}},
 CellLabel->"Out[4]=",ExpressionUUID->"38ee3672-d640-4188-8ba1-60d45ec959cc"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["A General metric, fixed dimension.",
 FontColor->RGBColor[
  0.49411764705882355`, 0.13333333333333333`, 
   0.07058823529411765]]], "Section",
 CellChangeTimes->{{3.8119699331260815`*^9, 3.811970020216326*^9}, {
   3.811970074069496*^9, 3.8119700773024535`*^9}, {3.8119701808606973`*^9, 
   3.81197018950849*^9}, {3.8119725007500496`*^9, 3.811972510171292*^9}, {
   3.811972809033696*^9, 3.8119728533628626`*^9}, {3.811972989033469*^9, 
   3.8119729960012045`*^9}, 3.8119730746203375`*^9, {3.8119757015673122`*^9, 
   3.8119757048375025`*^9}, {3.8119759235406914`*^9, 
   3.811975925804783*^9}},ExpressionUUID->"cd60ee3f-f37a-4380-8fa6-\
cabb31231fa1"],

Cell["\<\
For a general metric,  but a fixed spacetime dimension, it just prints the \
definition of the wave equations in expanded form:\
\>", "Text",
 CellChangeTimes->{{3.8119760958352346`*^9, 
  3.811976218491078*^9}},ExpressionUUID->"654adc93-c034-4589-af32-\
399d5ff89914"],

Cell[BoxData[
 RowBox[{
  RowBox[{"general2", "=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], 
       RowBox[{
        RowBox[{
         RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], 
       RowBox[{
        RowBox[{
         RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}]}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.811976001280454*^9, 3.811976019589985*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"32577245-d7c7-4cd1-a6e6-6c9348b06e8d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScalarWaveEquation", "[", 
  RowBox[{
   RowBox[{"\"\<metric\>\"", "\[Rule]", "general2"}], " ", ",", " ", 
   RowBox[{"\"\<coordinates\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}]}], ",", 
   RowBox[{"\"\<sol\>\"", "\[Rule]", "\[CapitalPsi]"}], ",", " ", 
   RowBox[{"\"\<mass\>\"", "\[Rule]", "m"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8119760273330746`*^9, 3.8119760578142753`*^9}, {
  3.817572675285606*^9, 3.817572695787779*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"5ff75e07-e939-4a56-ac52-b8f8431fc271"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["m", "2"]}], " ", 
   RowBox[{"\[CapitalPsi]", "[", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[CapitalPsi]", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{
                RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}], " ", 
             RowBox[{
              RowBox[{
               RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{
                RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}], " ", 
             RowBox[{
              RowBox[{
               RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{
                RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}], " ", 
             RowBox[{
              RowBox[{
               RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{
                RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], 
               TagBox[
                RowBox[{"(", 
                 RowBox[{"0", ",", "1"}], ")"}],
                Derivative],
               MultilineFunction->None], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}], " ", 
             RowBox[{
              RowBox[{
               RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}], " ", 
          SqrtBox[
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}], " ", 
             RowBox[{
              RowBox[{
               RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}], " ", 
             RowBox[{
              RowBox[{
               RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], ")"}], "/", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              RowBox[{
               RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
              RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
            RowBox[{
             RowBox[{
              RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
             RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
             RowBox[{"x1", ",", "x2"}], "]"}], " ", 
            RowBox[{
             RowBox[{
              RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
             RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}], "2"]}], ")"}]}], 
     "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}], "2"]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{
               RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
             RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{
               RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
             RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{
               RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
             RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{
               RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{
              RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
             RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
            RowBox[{"x1", ",", "x2"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["\[CapitalPsi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{
           RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
          RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}]}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["\[CapitalPsi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{
           RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
          RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}]}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["\[CapitalPsi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{
           RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
          RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["\[CapitalPsi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox[
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{
           RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
          RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["\[CapitalPsi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"0", ",", "2"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
       RowBox[{
        RowBox[{
         RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{
           RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
          RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}]}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["\[CapitalPsi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
       RowBox[{
        RowBox[{
         RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{
           RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
          RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}]}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["\[CapitalPsi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
       RowBox[{
        RowBox[{
         RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{
           RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
          RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["\[CapitalPsi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"2", ",", "0"}], "}"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}], "]"}], " ", 
       RowBox[{
        RowBox[{
         RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
           RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{
           RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
          RowBox[{"x1", ",", "x2"}], "]"}]}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
         RowBox[{"x1", ",", "x2"}], "]"}]}]}]]}], ")"}], "/", 
   RowBox[{"(", 
    SqrtBox[
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"metric", "[", "1", "]"}], "[", "2", "]"}], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], " ", 
       RowBox[{
        RowBox[{
         RowBox[{"metric", "[", "2", "]"}], "[", "1", "]"}], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"metric", "[", "1", "]"}], "[", "1", "]"}], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], " ", 
       RowBox[{
        RowBox[{
         RowBox[{"metric", "[", "2", "]"}], "[", "2", "]"}], "[", 
        RowBox[{"x1", ",", "x2"}], "]"}]}]}]], ")"}]}]}]], "Output",
 CellChangeTimes->{3.8175728115017643`*^9, 3.8175730622035265`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"5772f8d0-8ccd-4719-8eda-6a2724835468"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1428., 741.75},
WindowMargins->{{Automatic, 1152}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"11637ac8-f7e9-4c3f-9c74-6ca33b7d75f0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 179, 2, 28, "Input",ExpressionUUID->"b73ff2ba-a12a-4d5f-9b19-02969dca8e19"],
Cell[740, 24, 246, 4, 28, "Input",ExpressionUUID->"1566c1a4-42cb-4cd2-b999-704304b322a8"],
Cell[CellGroupData[{
Cell[1011, 32, 642, 10, 97, "Title",ExpressionUUID->"ac30e820-0294-4cd7-9b48-0cf6897ac71f"],
Cell[1656, 44, 413, 7, 32, "Author",ExpressionUUID->"2736abb2-a875-41d4-be90-7299de9e1855"],
Cell[2072, 53, 854, 16, 34, "Text",ExpressionUUID->"96bd5ab5-ab6b-455e-bdcf-890ee9b5a8b5"],
Cell[2929, 71, 1042, 26, 51, "DisplayFormulaNumbered",ExpressionUUID->"6d67255a-d232-402f-a6f1-80fb5834af95"],
Cell[3974, 99, 281, 6, 34, "Text",ExpressionUUID->"76d98c0d-0d84-4e85-96c2-763e24dee851"],
Cell[4258, 107, 262, 5, 28, "Input",ExpressionUUID->"92b7f799-d19c-4fa6-8846-af311df91674"],
Cell[CellGroupData[{
Cell[4545, 116, 369, 7, 28, "Input",ExpressionUUID->"db9235ca-cfea-4626-ba92-ae813f4b153b"],
Cell[4917, 125, 47775, 1035, 157, "Output",ExpressionUUID->"b001d4c5-f0b7-4ba1-9629-cb4661c740ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52729, 1165, 240, 4, 28, "Input",ExpressionUUID->"ce30a9a0-cd67-444a-8766-29615d2ba99b"],
Cell[52972, 1171, 606, 11, 43, "Print",ExpressionUUID->"d816fb23-1438-40d0-ae8d-030bb7e2dbfa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53615, 1187, 423, 8, 66, "Section",ExpressionUUID->"55464637-aa7d-4d7a-924a-9974d469d9a8"],
Cell[CellGroupData[{
Cell[54063, 1199, 271, 5, 45, "Subsubsection",ExpressionUUID->"6baf5bd3-378e-4d25-802a-0b6cab5c1616"],
Cell[54337, 1206, 256, 6, 34, "Text",ExpressionUUID->"7e9546e8-ce3a-4826-8d8f-533281010c05"],
Cell[CellGroupData[{
Cell[54618, 1216, 257, 4, 28, "Input",ExpressionUUID->"06c8ca99-3704-4c6e-999b-ccf8482d3234"],
Cell[54878, 1222, 27188, 609, 117, "Output",ExpressionUUID->"26063d99-7d88-4e8b-8615-27f9f121b740"]
}, Open  ]],
Cell[82081, 1834, 156, 3, 34, "Text",ExpressionUUID->"ee394dc0-9609-43f1-8980-b78e7c0c20d0"],
Cell[CellGroupData[{
Cell[82262, 1841, 1486, 27, 33, "Input",ExpressionUUID->"f53db22d-5f18-4afc-b625-d4908c1e6a40"],
Cell[83751, 1870, 1629, 44, 53, "Output",ExpressionUUID->"78683a37-6681-433d-af7a-a450a84c19fc"]
}, Open  ]],
Cell[85395, 1917, 322, 7, 34, "Text",ExpressionUUID->"a9bd6ada-192c-468c-a31d-e766151e98a5"],
Cell[CellGroupData[{
Cell[85742, 1928, 672, 16, 33, "Input",ExpressionUUID->"0c3d351d-9951-484b-850c-ce7bcafd6623"],
Cell[86417, 1946, 17440, 444, 192, "Output",ExpressionUUID->"df481b78-8a60-41f6-a386-33712084ca83"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[103906, 2396, 337, 6, 45, "Subsubsection",ExpressionUUID->"b455d6bf-146a-4c23-9e50-b145175e592c"],
Cell[CellGroupData[{
Cell[104268, 2406, 1631, 45, 44, "Input",ExpressionUUID->"bcdc8425-9e95-4297-859e-a2c30e99b5f9"],
Cell[105902, 2453, 1601, 42, 57, "Output",ExpressionUUID->"9f6da46a-3e33-4e19-8431-3def23ff6baf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[107552, 2501, 319, 6, 45, "Subsubsection",ExpressionUUID->"3151f513-9e6a-44a8-a089-b73c4f240f05"],
Cell[CellGroupData[{
Cell[107896, 2511, 1332, 33, 47, "Input",ExpressionUUID->"f8ea01f3-9ece-4769-88b0-9ab56561c2f7"],
Cell[109231, 2546, 429, 10, 61, "Message",ExpressionUUID->"d1970fe9-26f6-4d69-8536-7e0ef5cd7f12"]
}, Open  ]],
Cell[109675, 2559, 179, 3, 34, "Text",ExpressionUUID->"dff8cae5-c15d-4136-8554-c02b7b41f7f7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109903, 2568, 592, 10, 66, "Section",ExpressionUUID->"e2fb7e8d-596b-40e4-8729-c6b66b7d39d2"],
Cell[CellGroupData[{
Cell[110520, 2582, 226, 3, 28, "Input",ExpressionUUID->"cee8dfe0-8221-401e-96f3-e4a3b3d1d492"],
Cell[110749, 2587, 867, 20, 32, "Output",ExpressionUUID->"3dfe0e60-fdcc-4c1c-80c3-61ec0b5cbadb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111653, 2612, 350, 6, 45, "Subsubsection",ExpressionUUID->"9776e87f-f443-407f-8709-22b47f7944b0"],
Cell[112006, 2620, 278, 4, 34, "Text",ExpressionUUID->"6cedc09f-6b41-453f-86f7-f23cf893a6e0"],
Cell[CellGroupData[{
Cell[112309, 2628, 385, 7, 28, "Input",ExpressionUUID->"58911ab8-7036-4531-a413-7e0d3205ded4"],
Cell[112697, 2637, 2029, 64, 54, "Output",ExpressionUUID->"8f0e29ba-f0ed-4be6-a45b-e111e6fd551a"]
}, Open  ]],
Cell[114741, 2704, 477, 9, 56, "Text",ExpressionUUID->"01457409-7a85-401e-be08-7913f4e863a3"],
Cell[CellGroupData[{
Cell[115243, 2717, 698, 18, 33, "Input",ExpressionUUID->"4c7d61e4-cc4c-4497-9ee4-97b2dca5fe94"],
Cell[115944, 2737, 1654, 52, 54, "Output",ExpressionUUID->"696a5910-21f7-4b2a-8a09-0e2ab54d8a90"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[117647, 2795, 355, 6, 45, "Subsubsection",ExpressionUUID->"5e8aff79-3396-43df-8d31-ba9d00b7e64c"],
Cell[118005, 2803, 458, 10, 56, "Text",ExpressionUUID->"6dcb0e6e-f501-4b1b-af2d-802269886877"],
Cell[CellGroupData[{
Cell[118488, 2817, 803, 17, 28, "Input",ExpressionUUID->"acb647e3-400a-4dac-bbaa-5de2eda155a9"],
Cell[119294, 2836, 2128, 67, 53, "Output",ExpressionUUID->"1f9938b1-47cf-47dd-83d4-aa9ba8fa82e8"]
}, Open  ]],
Cell[121437, 2906, 176, 3, 34, "Text",ExpressionUUID->"cd96fb4b-83b4-4ee2-9622-245ea37be5f1"],
Cell[CellGroupData[{
Cell[121638, 2913, 1411, 29, 33, "Input",ExpressionUUID->"80f97d21-a0be-49f7-9f3e-fb8d998029ca"],
Cell[123052, 2944, 569, 13, 51, "Output",ExpressionUUID->"8d504230-bdd0-48e6-a1b7-49ae7e069142"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123658, 2962, 298, 6, 28, "Input",ExpressionUUID->"b35908dc-1fa8-4aef-982a-4fcf84bb26d6"],
Cell[123959, 2970, 670, 19, 32, "Output",ExpressionUUID->"571e6e18-fcfa-4bc1-8dff-538236468cba"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[124678, 2995, 370, 6, 45, "Subsubsection",ExpressionUUID->"5120552f-77fa-44b7-9e76-e373c492ec85"],
Cell[125051, 3003, 576, 10, 34, "Text",ExpressionUUID->"e68541f0-d271-4d12-96a1-5f260f296521"],
Cell[CellGroupData[{
Cell[125652, 3017, 1821, 34, 33, "Input",ExpressionUUID->"1447f64f-2520-4b61-9384-38fc20a1b1b7"],
Cell[127476, 3053, 914, 23, 51, "Output",ExpressionUUID->"38ee3672-d640-4188-8ba1-60d45ec959cc"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[128451, 3083, 677, 11, 66, "Section",ExpressionUUID->"cd60ee3f-f37a-4380-8fa6-cabb31231fa1"],
Cell[129131, 3096, 279, 6, 34, "Text",ExpressionUUID->"654adc93-c034-4589-af32-399d5ff89914"],
Cell[129413, 3104, 843, 24, 44, "Input",ExpressionUUID->"32577245-d7c7-4cd1-a6e6-6c9348b06e8d"],
Cell[CellGroupData[{
Cell[130281, 3132, 570, 11, 28, "Input",ExpressionUUID->"5ff75e07-e939-4a56-ac52-b8f8431fc271"],
Cell[130854, 3145, 51808, 1484, 933, "Output",ExpressionUUID->"5772f8d0-8ccd-4719-8eda-6a2724835468"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

